1.é€‰æ‹©æ•°æ®â€”â€”sid  è¾–åŒºä»£ç ï¼ˆæ’åºï¼‰ æ—¶é—´ï¼ˆæ’åºï¼‰ åœ°ç†ä½ç½®  æŸå¤±æƒ…å†µæè¿°ï¼ˆå·²åˆ é™¤çš„åˆ é™¤ï¼‰ å…³æ³¨è­¦æƒ…ç±»åˆ«ï¼ˆå…¥æˆ·ç›—çªƒï¼‰
   select sid ,"è¾–åŒºä»£ç ","æ—¶é—´","åœ°ç†ä½ç½®","å…³æ³¨è­¦æƒ…ç±»åˆ«" from incident."æ ¸è­¦ä¿¡æ¯è¡¨"
2.å­˜å…¥æ–‡ä»¶--å®¢æˆ·ç«¯æ‹‰å–æœåŠ¡ç«¯æ•°æ®è‡³æœ¬åœ°
 1) https://blog.csdn.net/fm0517/article/details/52995951  copyé‡å®šå‘Ã—
 2) è£… Python3 è¯»å–å¦å­˜ä¸ºcsv ğŸ‘Œ  å‚è§ https://www.yiibai.com/postgresql/postgresql_python.html
 3)  create extension postgis  --æ”¯æŒç©ºé—´æ•°æ®  å‚è§https://blog.csdn.net/Daisy_jf/article/details/95947151?depth_1-utm_source=distribute.pc_relevant.none-task&utm_source=distribute.pc_relevant.none-task
 4ï¼‰åˆ›å»ºè¡¨ 
                             æ•°æ®è¡¨ "incident.æ ¸è­¦ä¿¡æ¯è¡¨"
        æ ä½     |          ç±»å‹           | Collation | Nullable | Default
   --------------+-------------------------+-----------+----------+---------
    sid          | character(36)           |           |          |
    æ¥è­¦å•ç¼–å·   | character varying(40)   |           |          |
    è¾–åŒºä»£ç      | character varying(32)   |           |          |
    è¾–åŒºåç§°     | character varying(128)  |           |          |
    æ—¶é—´         | character varying(14)   |           |          |
    å†…å®¹         | character varying(2000) |           |          |
    åœ°å€         | character varying(256)  |           |          |
    åœ°ç†ä½ç½®     | geography(Point,4326)   |           |          |
    æŸå¤±æƒ…å†µæè¿° | character varying(2000) |           |          |
    å…³æ³¨è­¦æƒ…ç±»åˆ« | character varying(32)   |           |          |
   postgres=# create extension postgis;
   CREATE EXTENSION
   postgres=# create table da (sid character(36),xiaqu  character varying(32) ,time character varying(14),location geography(Point,4326),type character varying(32));
   CREATE TABLE
   
  5) Pythonæ’å…¥æ•°æ®
   import psycopg2
   #è¿æ¥æ•°æ®åº“
   conn = psycopg2.connect(database="crimeanalysis", user="crimeanalysis", password="58955X", host="132.1.11.157", port="5432")
   conn1 = psycopg2.connect(database="postgres", user="postgres", password="zhangjie1234", host="127.0.0.1", port="5432")
   print("Opened database successfully")

   #æ•°æ®æ¸¸æ ‡
   cur = conn.cursor()
   cur1 = conn1.cursor()

   #selectæ“ä½œ
   cur.execute("select sid,"'è¾–åŒºä»£ç '","'æ—¶é—´'" ,"'åœ°ç†ä½ç½®'","'å…³æ³¨è­¦æƒ…ç±»åˆ«'" from incident."'æ ¸è­¦ä¿¡æ¯è¡¨'"")
   rows = cur.fetchall()
   for row in rows:   
       sql1="insert into da values"+str(row)
       #print(sql1)
       cur1.execute(sql1)
   conn1.commit()#æäº¤è¿è¡Œç»“æœ
   print("æ’å…¥æˆåŠŸ")
   #sql2 = "select * from da"
   #cur1.execute(sql2)
   #rows = cur1.fetchall()
   #for row in rows:
       #print(str(row))
   cur.close()
   cur1.close()
   conn.close()
   conn1.close()
 6)backup å¤‡ä»½è‡³æœ¬åœ°â€”â€”â€”â€”ä»¥ä¾¿ä¼ å…¥å¦ä¸€ä¸ªæ¡Œé¢çš„æœ¬åœ°æ•°æ®åº“ Custom UTF8
 7ï¼‰æœ¬åœ°restore :  create extension postgis;å®‰è£…ç©ºé—´æ•°æ®åº“æ‹“å±• ï¼Œrestore .backup ğŸ†—
 
 
 
æ•°æ®2
1ï¼‰æ•°æ®ç±»å‹â€”â€”è­¦æƒ…ä¿¡æ¯è¡¨ã€è­¦æƒ…è¡¨ã€eventdetail.     pgadminæœ¬åœ°å»ºè¡¨

crimeanalysis=> \d incident."è­¦æƒ…ä¿¡æ¯è¡¨"
 sid              | character(32)               |           |          |
 è­¦æƒ…çŠ¶æ€         | smallint                    |           |          |
 è¡Œæ”¿åŒºåˆ’ä»£ç      | character(12)               |           |          |
 è¡Œæ”¿åŒºåˆ’åç§°     | character varying(128)      |           |          |
 æ¥è­¦å•å·         | character varying(40)       |           |          |
 æ¥è­¦æƒ…å†µ         | common.udt_response         |           |          |
 æ¥è­¦è­¦æƒ…         | common.udt_police_record    |           |          |
 æ¥è­¦å¤‡æ³¨         | character varying(256)      |           |          |
 æ¥è­¦æ›´æ–°æ ‡è¯†     | character(6)                |           |          |
 æ¥è­¦æœ€åæ›´æ–°æ—¶é—´ | timestamp without time zone |           |          |
 å¤„è­¦å•å·         | character varying(40)       |           |          |
 å¤„è­¦æƒ…å†µ         | common.udt_response         |           |          |
 å¤„è­¦æ„è§         | character varying(256)      |           |          |
 å¤„è­¦æ„è§æ ‡ç­¾     | character varying(64)[]     |           |          |
 å¤„è­¦æ›´æ–°æ ‡è¯†     | character(6)                |           |          |
 å¤„è­¦æœ€åæ›´æ–°æ—¶é—´ | timestamp without time zone |           |          |
 åé¦ˆå•å·         | character varying(40)       |           |          |
 å‡ºè­¦æƒ…å†µ         | common.udt_response         |           |          |
 å‡ºè­¦è­¦æƒ…         | common.udt_police_record    |           |          |
 å¤„ç†ç»“æœä»£ç      | character(6)                |           |          |
 å¤„ç†ç»“æœæè¿°     | character varying(2000)     |           |          |
 æŸå¤±æƒ…å†µæè¿°     | character varying(2000)     |           |          |
 åé¦ˆæ›´æ–°æ ‡è¯†     | character(6)                |           |          |
 åé¦ˆæœ€åæ›´æ–°æ—¶é—´ | timestamp without time zone |           |          |
 æ ¸è­¦å•å·         | character varying(40)       |           |          |
 æ ¸è­¦æƒ…å†µ         | common.udt_response         |           |          |
 æ ¸è­¦è­¦æƒ…         | common.udt_police_record    |           |          |
 ç ”åˆ¤æƒ…å†µæè¿°     | character varying(512)      |           |          |
 ç ”åˆ¤æƒ…å†µæ ‡ç­¾     | character varying[]         |           |          |
 æ ¸è­¦æ›´æ–°æ ‡è¯†     | character(6)                |           |          |
 æ ¸è­¦æœ€åæ›´æ–°æ—¶é—´ | timestamp without time zone |           |          |

  crimeanalysis=> \d incident."è­¦æƒ…è¡¨"
                            æ•°æ®è¡¨ "incident.è­¦æƒ…è¡¨"
        æ ä½        |           ç±»å‹           | Collation | Nullable | Default
--------------------+--------------------------+-----------+----------+---------
 ç³»ç»Ÿç¼–å·           | character(36)            |           | not null |
 è­¦æƒ…çŠ¶æ€           | integer                  |           |          |
 è¡Œæ”¿åŒºåˆ’ä»£ç        | character(6)             |           |          |
 è¡Œæ”¿åŒºåˆ’åç§°       | character varying(128)   |           |          |
 æ¥è­¦å•ç¼–å·         | character varying(40)    |           |          |
 æ¥è­¦å•ä½ä»£ç        | character varying(32)    |           |          |
 æ¥è­¦å•ä½åç§°       | character varying(128)   |           |          |
 æŠ¥è­¦æ—¶é—´           | character varying(14)    |           |          |
 æ¥è­¦æ—¶é—´           | character varying(14)    |           |          |
 æ¥è­¦å®Œæˆæ—¶é—´       | character varying(14)    |           |          |
 æŠ¥è­¦æ–¹å¼           | character(2)             |           |          |
 æŠ¥è­¦å†…å®¹æ ‡ç­¾é›†     | json                     |           |          |
 æŠ¥è­¦å†…å®¹           | character varying(2000)  |           |          |
 æŠ¥è­¦åœ°å€           | character varying(256)   |           |          |
 æŠ¥è­¦åœ°ç†ä½ç½®       | geography(Point,4326)    |           |          |
 æŠ¥è­¦æ¶‰äººä¿¡æ¯æ ‡ç­¾   | json                     |           |          |
 æŠ¥è­¦æ¶‰äººä¿¡æ¯è¯¦æƒ…   | character varying(2000)  |           |          |
 æŠ¥è­¦æ¶‰è½¦ä¿¡æ¯æ ‡ç­¾   | json                     |           |          |
 æŠ¥è­¦æ¶‰è½¦ä¿¡æ¯è¯¦æƒ…   | character varying(2000)  |           |          |
 æŠ¥è­¦æ¶‰ç‰©ä¿¡æ¯æ ‡ç­¾   | json                     |           |          |
 æŠ¥è­¦æ¶‰ç‰©ä¿¡æ¯è¯¦æƒ…   | character varying(2000)  |           |          |
 æŠ¥è­¦æ¶‰è´¢ä¿¡æ¯æ ‡ç­¾   | json                     |           |          |
 æŠ¥è­¦æ¶‰è´¢ä¿¡æ¯è¯¦æƒ…   | character varying(2000)  |           |          |
 æŠ¥è­¦äºº             | json                     |           |          |
 æŠ¥è­¦ç”µè¯           | json                     |           |          |
 æ¥è­¦ç±»å‹           | character(2)             |           |          |
 è­¦æƒ…åˆ†ç±»ä»£ç (æ¥è­¦) | character varying(6)     |           |          |
 è­¦æƒ…ç±»å‹ä»£ç (æ¥è­¦) | character varying(6)     |           |          |
 è­¦æƒ…ç»†ç±»ä»£ç (æ¥è­¦) | character varying(6)     |           |          |
 æ¥è­¦å¤‡æ³¨           | character varying(128)   |           |          |
 æ¥è­¦äººå‘˜           | character varying(128)   |           |          |
 æ¥è­¦æ›´æ–°æ ‡è¯†       | character(6)             |           |          |
 æ¥è­¦æœ€åæ›´æ–°æ—¶é—´   | timestamp with time zone |           |          |
 å¤„è­¦å•ç¼–å·         | character varying(40)    |           |          |
 å¤„è­¦å•ä½ä»£ç        | character varying(32)    |           |          |
 å¤„è­¦å•ä½åç§°       | character varying(128)   |           |          |
 å¤„è­¦æ—¶é—´           | character varying(14)    |           |          |
 å‡ºè­¦å•ä½ä»£ç        | character varying(32)    |           |          |
 å‡ºè­¦å•ä½åç§°       | character varying(128)   |           |          |
 æ¥å•æ—¶é—´           | character varying(14)    |           |          |
 å¤„è­¦æ„è§æ ‡ç­¾       | json                     |           |          |
 å¤„è­¦æ„è§å†…å®¹       | character varying(2000)  |           |          |
 å‡ºè­¦äººå‘˜           | json                     |           |          |
 å‡ºè­¦è½¦è¾†           | json                     |           |          |
 å¤„è­¦å¤‡æ³¨           | character varying(128)   |           |          |
 å¤„è­¦äººå‘˜           | character varying(200)   |           |          |
 å¤„è­¦æ›´æ–°æ ‡è¯†       | character(6)             |           |          |
 å¤„è­¦æœ€åæ›´æ–°æ—¶é—´   | timestamp with time zone |           |          |
 åé¦ˆå•ç¼–å·         | character varying(40)    |           |          |
 åé¦ˆå•ä½ä»£ç        | character varying(32)    |           |          |
 åé¦ˆå•ä½åç§°       | character varying(128)   |           |          |
 æ¥å•æ—¶é—´(åŒä¸Š)     | character varying(14)    |           |          |
 å‡ºè­¦æ—¶é—´           | character varying(14)    |           |          |
 åˆ°è¾¾æ—¶é—´           | character varying(14)    |           |          |
 åé¦ˆæ—¶é—´           | character varying(14)    |           |          |
 å¤©æ°”æƒ…å†µ           | json                     |           |          |
 è­¦æƒ…åˆ†ç±»ä»£ç (å‡ºè­¦) | character varying(6)     |           |          |
 è­¦æƒ…ç±»å‹ä»£ç (å‡ºè­¦) | character varying(6)     |           |          |
 è­¦æƒ…ç»†ç±»ä»£ç (å‡ºè­¦) | character varying(6)     |           |          |
 è­¦æƒ…å…³æ³¨ç±»åˆ«(å‡ºè­¦) | character varying(32)    |           |          |
 å¤„è­¦æƒ…å†µæ ‡ç­¾       | json                     |           |          |
 å‡ºè­¦æƒ…å†µ           | character varying(2000)  |           |          |
 å‡ºè­¦äººå‘˜æƒ…å†µ       | json                     |           |          |
 å‡ºè­¦è½¦è¾†æƒ…å†µ       | json                     |           |          |
 äº‹å‘æ—¶é—´           | json                     |           |          |
 äº‹å‘åœ°å€           | json                     |           |          |
 äº‹å‘åœ°ç†ä½ç½®       | geography(Point,4326)    |           |          |
 äº‹å‘åœºæ‰€ä¿¡æ¯æ ‡ç­¾   | json                     |           |          |
 äº‹å‘åœºæ‰€ä¿¡æ¯è¯¦æƒ…   | json                     |           |          |
 äº‹å‘æ¶‰äººä¿¡æ¯æ ‡ç­¾   | json                     |           |          |
 äº‹å‘æ¶‰äººä¿¡æ¯è¯¦æƒ…   | json                     |           |          |
 äº‹å‘æ¶‰è½¦ä¿¡æ¯æ ‡ç­¾   | json                     |           |          |
 äº‹å‘æ¶‰è½¦ä¿¡æ¯è¯¦æƒ…   | json                     |           |          |
 äº‹å‘æ¶‰ç‰©ä¿¡æ¯æ ‡ç­¾   | json                     |           |          |
 äº‹å‘æ¶‰ç‰©ä¿¡æ¯è¯¦æƒ…   | json                     |           |          |
 äº‹å‘æ¶‰è´¢ä¿¡æ¯æ ‡ç­¾   | json                     |           |          |
 äº‹å‘æ¶‰è´¢ä¿¡æ¯è¯¦æƒ…   | json                     |           |          |
 äº‹å‘å‘¨è¾¹ä¿¡æ¯æ ‡ç­¾   | json                     |           |          |
 äº‹å‘å‘¨è¾¹ä¿¡æ¯è¯¦æƒ…   | json                     |           |          |
 å¤„ç†ç»“æœä»£ç        | character varying(6)     |           |          |
 å¤„ç†ç»“æœæè¿°       | character varying(2000)  |           |          |
 æŸå¤±æƒ…å†µæè¿°       | character varying(2000)  |           |          |
 åé¦ˆå¤‡æ³¨           | character varying(128)   |           |          |
 åé¦ˆäººå‘˜           | character varying(128)   |           |          |
 åé¦ˆæ›´æ–°æ ‡è¯†       | character(6)             |           |          |
 åé¦ˆæœ€åæ›´æ–°æ—¶é—´   | timestamp with time zone |           |          |
 æ ¸è­¦å•ç¼–å·         | character varying(40)    |           |          |
 æ ¸è­¦å•ä½ä»£ç        | character varying(32)    |           |          |
 æ ¸è­¦å•ä½åç§°       | character varying(128)   |           |          |
 æ ¸è­¦æ—¶é—´           | character varying(14)    |           |          |
 è­¦æƒ…åˆ†ç±»ä»£ç (æ ¸è­¦) | character varying(6)     |           |          |
 è­¦æƒ…ç±»å‹ä»£ç (æ ¸è­¦) | character varying(6)     |           |          |
 è­¦æƒ…ç»†ç±»ä»£ç (æ ¸è­¦) | character varying(6)     |           |          |
 è­¦æƒ…å…³æ³¨ç±»åˆ«(æ ¸è­¦) | character varying(32)    |           |          |
 æ ¸è­¦åœ°å€           | json                     |           |          |
 æ ¸è­¦åœ°ç†ä½ç½®       | geography(Point,4326)    |           |          |
 è­¦æƒ…æè¿°æ ‡ç­¾       | json                     |           |          |
 è­¦æƒ…æè¿°           | json                     |           |          |
 è­¦æƒ…æ—¶é—´æ ‡ç­¾       | json                     |           |          |
 è­¦æƒ…æ—¶é—´æè¿°       | json                     |           |          |
 æŠ¥è­¦äººä¿¡æ¯æ ‡ç­¾     | json                     |           |          |
 æŠ¥è­¦äººä¿¡æ¯è¯¦æƒ…     | json                     |           |          |
 å—å®³äººä¿¡æ¯æ ‡ç­¾     | json                     |           |          |
 å—å®³äººä¿¡æ¯è¯¦æƒ…     | json                     |           |          |
 å«Œç–‘äººä¿¡æ¯æ ‡ç­¾     | json                     |           |          |
 å«Œç–‘äººä¿¡æ¯è¯¦æƒ…     | json                     |           |          |
 å«Œç–‘è½¦è¾†ä¿¡æ¯æ ‡ç­¾   | json                     |           |          |
 å«Œç–‘è½¦è¾†ä¿¡æ¯è¯¦æƒ…   | json                     |           |          |
 äº‹å‘åœ°ç‚¹æ ‡ç­¾       | json                     |           |          |
 äº‹å‘åœ°ç‚¹è¯¦æƒ…       | json                     |           |          |
 å‘¨è¾¹æƒ…å†µæ ‡ç­¾       | json                     |           |          |
 å‘¨è¾¹æƒ…å†µè¯¦æƒ…       | json                     |           |          |
 æ¶‰æ¡ˆç‰©å“æ ‡ç­¾       | json                     |           |          |
 æ¶‰æ¡ˆç‰©å“è¯¦æƒ…       | json                     |           |          |
 æ¶‰æ¡ˆé€šè®¯æ ‡ç­¾       | json                     |           |          |
 æ¶‰æ¡ˆé€šè®¯è¯¦æƒ…       | json                     |           |          |
 æ¶‰æ¡ˆé‡‘é¢æ ‡ç­¾       | json                     |           |          |
 æ¶‰æ¡ˆé‡‘é¢è¯¦æƒ…       | json                     |           |          |
 æ¶‰æ¡ˆæ‰‹æ®µæ ‡ç­¾       | json                     |           |          |
 æ¶‰æ¡ˆæ‰‹æ®µè¯¦æƒ…       | json                     |           |          |
 æ¶‰æ¡ˆéƒ¨ä½æ ‡ç­¾       | json                     |           |          |
 æ¶‰æ¡ˆéƒ¨ä½è¯¦æƒ…       | json                     |           |          |
 ç ”åˆ¤æƒ…å†µæ ‡ç­¾       | json                     |           |          |
 ç ”åˆ¤æƒ…å†µ           | json                     |           |          |
 æ ¸è­¦å¤‡æ³¨           | character varying(128)   |           |          |
 æ ¸è­¦äººå‘˜           | character varying(128)   |           |          |
 æ ¸è­¦æ›´æ–°æ ‡è¯†       | character(6)             |           |          |
 æ ¸è­¦æœ€åæ›´æ–°æ—¶é—´   | timestamp with time zone |           |          |
ç´¢å¼•ï¼š
    "pk_jingqing" PRIMARY KEY, btree ("ç³»ç»Ÿç¼–å·")
    "uk_jingqing" UNIQUE CONSTRAINT, btree ("æ¥è­¦å•ç¼–å·", "å¤„è­¦å•ç¼–å·", "åé¦ˆå•ç¼–å·", "æ ¸è­¦å•ç¼–å·")
  

crimeanalysis=> \d textanalysis.eventdetail320500_0520
          æ•°æ®è¡¨ "textanalysis.eventdetail320500_0520"
          æ ä½          | ç±»å‹ | Collation | Nullable | Default
------------------------+------+-----------+----------+---------
 æŠ½å–ç¼–å·               | text |           |          |
 è­¦æƒ…ç¼–å·               | text |           |          |
 æ¥è­¦ç¼–å·               | text |           |          |
 æ¥è­¦å•ç¼–å·             | text |           |          |
 æ¥è­¦æ—¶é—´               | text |           |          |
 æŠ¥è­¦æ–¹å¼               | text |           |          |
 å¤„è­¦ç¼–å·               | text |           |          |
 å¤„è­¦æ—¶é—´               | text |           |          |
 å¤„è­¦å•ä½               | text |           |          |
 å‘æ¡ˆè¯¦å€               | text |           |          |
 æŠ¥è­¦ä½ç½®               | text |           |          |
 æŠ¥è­¦å†…å®¹               | text |           |          |
 å¤„è­¦å†…å®¹               | text |           |          |
 åé¦ˆå†…å®¹               | text |           |          |
 æ¥è­¦ç±»åˆ«ç¼–ç            | text |           |          |
 æ¥è­¦ç±»åˆ«               | text |           |          |
 æŠ¥è­¦ç”µè¯               | text |           |          |
 å¤©æ°”æƒ…å†µç¼–ç            | text |           |          |
 å¤©æ°”æƒ…å†µ               | text |           |          |
 äº‹å‘åœºæ‰€ç¼–ç            | text |           |          |
 äº‹å‘åœºæ‰€               | text |           |          |
 äº‹å‘æ—¶é—´ä¸Šé™           | text |           |          |
 äº‹å‘æ—¶é—´ä¸‹é™           | text |           |          |
 å¤„è­¦ç±»åˆ«ç¼–ç            | text |           |          |
 å¤„è­¦ç±»åˆ«               | text |           |          |
 å¤„è­¦å¤§ç±»ç¼–ç            | text |           |          |
 å¤„è­¦å¤§ç±»               | text |           |          |
 å¤„è­¦ä¸­ç±»ç¼–ç            | text |           |          |
 å¤„è­¦ä¸­ç±»               | text |           |          |
 å¤„è­¦å°ç±»ç¼–ç            | text |           |          |
 å¤„è­¦å°ç±»               | text |           |          |
 æ‰€å±åˆ†å±€ç¼–ç            | text |           |          |
 æ‰€å±åˆ†å±€               | text |           |          |
 æ‰€å±æ´¾å‡ºæ‰€ç¼–ç          | text |           |          |
 æ‰€å±æ´¾å‡ºæ‰€             | text |           |          |
 ç‰©å“ç¼–ç                | text |           |          |
 ç‰©å“                   | text |           |          |
 å¤„è­¦ç»“æœ               | text |           |          |
 å—å®³äººæ€§åˆ«             | text |           |          |
 å¹´é¾„                   | text |           |          |
 æˆ·ç±ç±»å‹ç¼–ç            | text |           |          |
 æˆ·ç±ç±»å‹               | text |           |          |
 å¤„æ‰€ç¼–ç                | text |           |          |
 å¤„æ‰€                   | text |           |          |
 æ‰‹æ®µç¼–ç                | text |           |          |
 æ‰‹æ®µ                   | text |           |          |
 å‘æ¡ˆç®€å€               | text |           |          |
 ç®€è¦æ¡ˆæƒ…               | text |           |          |
 å•ä½ç¼–ç                | text |           |          |
 å•ä½                   | text |           |          |
 ç±»åˆ«ç¼–ç                | text |           |          |
 ç±»åˆ«                   | text |           |          |
 è‡ªå®šä¹‰å¤§ç±»ç¼–ç          | text |           |          |
 è‡ªå®šä¹‰å¤§ç±»             | text |           |          |
 è‡ªå®šä¹‰ä¸­ç±»ç¼–ç          | text |           |          |
 è‡ªå®šä¹‰ä¸­ç±»             | text |           |          |
 è‡ªå®šä¹‰å°ç±»ç¼–ç          | text |           |          |
 è‡ªå®šä¹‰å°ç±»             | text |           |          |
 å¤„æ‰€ç»†ç±»1ç¼–ç           | text |           |          |
 å¤„æ‰€ç»†ç±»1              | text |           |          |
 å¤„æ‰€ç»†ç±»2ç¼–ç           | text |           |          |
 å¤„æ‰€ç»†ç±»2              | text |           |          |
 éƒ¨ä½ç»†ç±»2ç¼–ç           | text |           |          |
 éƒ¨ä½ç»†ç±»2              | text |           |          |
 æ‰‹æ®µç»†ç±»ç¼–ç            | text |           |          |
 æ‰‹æ®µç»†ç±»               | text |           |          |
 è‡ªå®šä¹‰ç±»å‹1ç¼–ç         | text |           |          |
 è‡ªå®šä¹‰ç±»å‹1            | text |           |          |
 è‡ªå®šä¹‰ç±»å‹2ç¼–ç         | text |           |          |
 è‡ªå®šä¹‰ç±»å‹2            | text |           |          |
 æ±‡æ¬¾é“¶è¡Œåç§°           | text |           |          |
 æ±‡æ¬¾é“¶è¡Œåœ°ç‚¹           | text |           |          |
 æ¶‰æ¡ˆé‡‘é¢               | text |           |          |
 æ±‡è½¬æ–¹å¼ç¼–ç            | text |           |          |
 æ±‡è½¬æ–¹å¼               | text |           |          |
 å«Œç–‘äººè½¦æƒ…å†µ           | text |           |          |
 å—å®³äºº                 | text |           |          |
 æŠ“è·äººæ•°               | text |           |          |
 æ—¶æ®µ                   | text |           |          |
 å›è®¿æƒ…å†µ               | text |           |          |
 ç›‘æ§æƒ…å†µ               | text |           |          |
 å“ç‰Œ                   | text |           |          |
 è½¦å‹                   | text |           |          |
 å¤‡æ³¨                   | text |           |          |
 å•ä½å•†åº—åç§°           | text |           |          |
 æ˜¯å¦å¤§é¢æ ‡è®°           | text |           |          |
 æ¶‰æ¡ˆqqå·               | text |           |          |
 é“¶è¡Œç±»å‹ç¼–ç            | text |           |          |
 æ¶‰æ¡ˆé“¶è¡Œç±»å‹           | text |           |          |
 å«Œç–‘æ‰‹æœºå·             | text |           |          |
 å«Œç–‘è´¦å·               | text |           |          |
 è­¦æƒ…å†…å®¹               | text |           |          |
 æ‰€å±ç¤¾åŒºç¼–ç            | text |           |          |
 æ‰€å±ç¤¾åŒº               | text |           |          |
 æ‰€å±è´£ä»»åŒºç¼–ç          | text |           |          |
 æ‰€å±è´£ä»»åŒº             | text |           |          |
 ç‰©å“ä¸­æœ‰æ— æ‰‹æœº         | text |           |          |
 ç‰©å“æœ‰æ— ç”µè„‘           | text |           |          |
 æ ‡å‡†åœ°å€ç¼–ç            | text |           |          |
 æ ‡å‡†åœ°å€åç§°           | text |           |          |
 è¡—è·¯å··ç¼–ç              | text |           |          |
 è¡—è·¯å··åç§°             | text |           |          |
 å¤„ç†ç»“æœ               | text |           |          |
 è¿æ³•çŠ¯ç½ªå…³æ³¨ç±»è­¦æƒ…ç±»åˆ« | text |           |          |
 è¿æ³•çŠ¯ç½ªè­¦æƒ…å¤§ç±»       | text |           |          |
 æ—¥æœŸ                   | text |           |          |
 ç ”åˆ¤æ—¶é—´               | text |           |          |
 ç ”åˆ¤å‘¨                 | text |           |          |
 ç ”åˆ¤æœˆ                 | text |           |          |
 çŠ¶æ€                   | text |           |          |
 æ˜¯å¦å®Œæˆ               | text |           |          |
 æ˜¯å¦åŒæ­¥               | text |           |          |
 æŠ½å–äººè­¦å·             | text |           |          |
 æŠ½å–äºº                 | text |           |          |
 æŠ½å–æ—¶é—´               | text |           |          |
 æŠ½å–å•ä½ç¼–ç            | text |           |          |
 æŠ½å–å•ä½               | text |           |          |
 ç»åº¦                   | text |           |          |
 çº¬åº¦                   | text |           |          |
 specialkey             | text |           |          |
 æ˜¯å¦å®¡æ ¸               | text |           |          |
 ä»»åŠ¡æ ‡ç­¾               | text |           |          |
 ç±»å‹                   | text |           |          |
 ç±»å‹ç¼–ç                | text |           |          |
 æ ¸è­¦ç‰©å“ç¼–ç            | text |           |          |
 æ ¸è­¦ç‰©å“               | text |           |          |
 æ±‡æ¬¾é“¶è¡Œç¼–ç            | text |           |          |
 ç›‘æ§æœ‰æ— äººåƒ           | text |           |          |
 æ‰‹æ®µç»†ç±»2ç¼–ç           | text |           |          |
 æ‰‹æ®µç»†ç±»2              | text |           |          |
 è¯„ä¼°æ—¶é—´               | text |           |          |
 è¯„ä¼°äººè´¦å·             | text |           |          |
 æ ¸è­¦æ—¶é—´               | text |           |          |
 æ‰€å±ç‰‡åŒºç¼–ç            | text |           |          |
 æ‰€å±ç‰‡åŒº               | text |           |          |
 é¦–æ¬¡è¯„ä¼°æ—¶é—´           | text |           |          |
 æ˜¯å¦è¶…æ—¶               | text |           |          |
 
Pythonä»£ç ï¼šæå–æœ‰æ•ˆå­—æ®µå»ºè¡¨
#åˆ›å»ºè¡¨
import psycopg2
#è¿æ¥æ•°æ®åº“
conn1 = psycopg2.connect(database="postgres", user="postgres", password="zhangjie1234", host="127.0.0.1", port="5432")
print("Opened database successfully")

#æ•°æ®æ¸¸æ ‡
cur1 = conn1.cursor()
#åˆ›å»ºè­¦æƒ…ä¿¡æ¯è¡¨
sql = '''create table policein_aa (
        sid               character(32) ,                   
         æ¥è­¦å•å·          character varying(40),      
         æ¥è­¦æƒ…å†µ          text,         
         æ¥è­¦è­¦æƒ…          text,    
         å¤„è­¦å•å·          character varying(40),       
         å¤„è­¦æƒ…å†µ          text,         
         å¤„è­¦æ„è§          character varying(256),          
         å‡ºè­¦æƒ…å†µ          text,         
         å‡ºè­¦è­¦æƒ…          text);'''

#åˆ›å»ºè­¦æƒ…è¡¨
sql1='''create table policein_bb (
 ç³»ç»Ÿç¼–å·            character(36)            primary key          not null ,
 æ¥è­¦å•ç¼–å·          character varying(40)    unique,
 æ¥è­¦å•ä½ä»£ç         character varying(32)    ,
 æ¥è­¦å•ä½åç§°        character varying(128)  ,
 æ¥è­¦æ—¶é—´            character varying(14)    ,
 æŠ¥è­¦å†…å®¹            character varying(2000)  ,
 æŠ¥è­¦åœ°å€            character varying(256)  ,
 æŠ¥è­¦åœ°ç†ä½ç½®        geography(Point,4326)   ,
 æŸå¤±æƒ…å†µæè¿°        character varying(2000) ,
 è­¦æƒ…å…³æ³¨ç±»åˆ«_æ ¸è­¦  character varying(32)  );

'''


#åˆ›å»ºeventdetailè¡¨
sql2='''create table eventdetaill(
æŠ½å–ç¼–å·               text ,
 è­¦æƒ…ç¼–å·           text ,
 æ¥è­¦ç¼–å·                text ,
 æ¥è­¦å•ç¼–å·              text ,
 æ¥è­¦æ—¶é—´                text ,
 å‘æ¡ˆè¯¦å€                text ,
 æŠ¥è­¦ä½ç½®                text ,
 æŠ¥è­¦å†…å®¹                text ,
 æ¥è­¦ç±»åˆ«ç¼–ç             text ,
 æ¥è­¦ç±»åˆ«                text ,
 æŠ¥è­¦ç”µè¯                text ,
 äº‹å‘æ—¶é—´ä¸Šé™            text ,
 äº‹å‘æ—¶é—´ä¸‹é™            text ,
 å¤„è­¦ç±»åˆ«ç¼–ç             text ,
 å¤„è­¦ç±»åˆ«                text ,
 å¤„è­¦å¤§ç±»ç¼–ç             text ,
 å¤„è­¦å¤§ç±»                text,
 å¤„è­¦ä¸­ç±»ç¼–ç             text ,
 å¤„è­¦ä¸­ç±»               text ,
 å¤„è­¦å°ç±»ç¼–ç             text ,
 å¤„è­¦å°ç±»                text ,
 æ‰€å±åˆ†å±€ç¼–ç             text ,
 æ‰€å±åˆ†å±€                text,
 æ‰€å±æ´¾å‡ºæ‰€ç¼–ç           text ,
 æ‰€å±æ´¾å‡ºæ‰€              text ,
 æ—¶æ®µ                    text,
 æ‰€å±ç¤¾åŒºç¼–ç             text ,
 æ‰€å±ç¤¾åŒº                text ,
 æ‰€å±è´£ä»»åŒºç¼–ç           text ,
 æ‰€å±è´£ä»»åŒº              text ,
 ç»åº¦                    text,
 çº¬åº¦                    text ,
 æ˜¯å¦å®¡æ ¸                text,
 æ ¸è­¦æ—¶é—´                text 
        );'''
 

cur1.execute(sql)
cur1.execute(sql1)
cur1.execute(sql2)
print("åˆ›å»ºæˆåŠŸ")

conn1.commit()
cur1.close()
conn1.close()


#æ•°æ®2 å­˜è‡³æœ¬åœ°
#å…¨æå–å»ºè¡¨_å­˜è‡³æœ¬åœ°
import psycopg2
import csv
#è¿æ¥æ•°æ®åº“
conn = psycopg2.connect(database="crimeanalysis", user="crimeanalysis", password="58955X", host="132.1.11.157", port="5432")
conn1 = psycopg2.connect(database="postgres", user="postgres", password="zhangjie1234", host="127.0.0.1", port="5432")


print("Opened database successfully")

#æ•°æ®æ¸¸æ ‡
cur = conn.cursor()
cur1 = conn1.cursor()

#selectæ“ä½œ 
cur.execute("select * from incident."'è­¦æƒ…ä¿¡æ¯è¡¨'"")#ç©ºå€¼ä¸ºnone,æ›¿æ¢æˆnull
rows = cur.fetchall()
for row in rows:   
    sql1="insert into policein_a values"+str(row).replace('None','null')
    #print(sql1)
    cur1.execute(sql1)
conn1.commit()#æäº¤è¿è¡Œç»“æœ
print("æ’å…¥æˆåŠŸ")

cur.close()
cur1.close()
conn.close()
conn1.close()

#é—®é¢˜ï¼šæŸ¥è¯¢å†…å­˜ä¸è¶³
Traceback (most recent call last):
  File "C:/data/4.py", line 15, in <module>
    cur.execute("select * from incident."'è­¦æƒ…è¡¨'"")#ç©ºå€¼ä¸ºnone,æ›¿æ¢æˆnull
psycopg2.DatabaseError: out of memory for query result

----limit +åç§» æŸ¥è¯¢  åç§»åˆ°ä¸€å®šé‡ï¼Œè¿”å›ç»“æœæ•°é‡ä¸º0
import psycopg2
import csv
#è¿æ¥æ•°æ®åº“
conn = psycopg2.connect(database="crimeanalysis", user="crimeanalysis", password="58955X", host="132.1.11.157", port="5432")
conn1 = psycopg2.connect(database="postgres", user="postgres", password="zhangjie1234", host="127.0.0.1", port="5432")


print("Opened database successfully")

#æ•°æ®æ¸¸æ ‡
cur = conn.cursor()
cur1 = conn1.cursor()
#å¾ªç¯è·å–æ•°æ®
i=0
while( 1):
    sql="select * from incident."'è­¦æƒ…è¡¨'" limit 1000 offset " + str(1000*i)
    i=i+1
    print(sql)
    cur.execute(sql)
    rows=cur.fetchall()
    if(len(rows)>0):
        for row in rows:
           sql1="insert into policein_b values" + str(row).replace('None','null')
           cur1.execute(sql1)
    else:
        break
conn1.commit()#æäº¤è¿è¡Œç»“æœ
print("æ’å…¥æˆåŠŸ")

cur.close()
cur1.close()
conn.close()
conn1.close()
 
----select * from textanalysis.eventdetail320500_0520 limit 5000 offset 3680000
Traceback (most recent call last):
  File "C:/data/6.py", line 24, in <module>
    cur1.execute(sql1)
psycopg2.errors.OutOfMemory: é”™è¯¯:  å†…å­˜ç”¨å°½
DETAIL:  æ— æ³•è¯·æ±‚å¤§å° 40.

-----åˆ†æ®µæ’ï¼Œå…ˆæ’3500000æ¡
 import psycopg2
import csv
#è¿æ¥æ•°æ®åº“
conn = psycopg2.connect(database="crimeanalysis", user="crimeanalysis", password="589555", host="132.1.11.157", port="5432")
conn1 = psycopg2.connect(database="postgres", user="postgres", password="zhangjie1234", host="127.0.0.1", port="5432")


print("Opened database successfully")

#æ•°æ®æ¸¸æ ‡
cur = conn.cursor()
cur1 = conn1.cursor()
#å¾ªç¯è·å–æ•°æ®
i=0
while( 1):
    sql="select * from textanalysis.eventdetail320500_0520 limit 5000 offset " + str(5000*i+3500000)
    i=i+1
    
    cur.execute(sql)
    rows=cur.fetchall()
    if(len(rows)>0):
        for row in rows:
           sql1="insert into eventdetail values" + str(row).replace('None','null')
           cur1.execute(sql1)
    else:
        break
conn1.commit()#æäº¤è¿è¡Œç»“æœ
print("i:"+str(i))
print("æ’å…¥æˆåŠŸ")

cur.close()
cur1.close()
conn.close()
conn1.close()
   

â€”â€”â€”â€”â€”â€”backup && restore



























































